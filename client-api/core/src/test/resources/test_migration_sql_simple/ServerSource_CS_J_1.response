{"CSharpServer/.cs":"\r\nnamespace _DatabaseCommon\r\n{\r\n\tusing System;\r\n\tusing System.Collections;\r\n\tusing System.Collections.Generic;\r\n\r\n\tinternal static partial class Utility\r\n\t{\r\n\t\tpublic static T[] ConvertToArray<T>(List<T> source)\r\n\t\t{\r\n\t\t\treturn source != null ? source.ToArray() : null;\r\n\t\t}\r\n\t\tpublic static List<T> ConvertToList<T>(List<T> source)\r\n\t\t{\r\n\t\t\treturn source;\r\n\t\t}\r\n\t\tpublic static HashSet<T> ConvertToSet<T>(List<T> source)\r\n\t\t{\r\n\t\t\treturn source != null ? new HashSet<T>(source) : null;\r\n\t\t}\r\n\t}\r\n}\r\nnamespace _DatabaseCommon\r\n{\r\n\tusing System.Collections.Generic;\r\n\tusing System.IO;\r\n\tusing System.Text;\r\n\tusing NGS.DatabasePersistence.Postgres;\r\n\tusing NGS.DatabasePersistence.Postgres.Converters;\r\n\r\n\tinternal static partial class Utility\r\n\t{\r\n\t\tpublic static int? ToNullableInt(this string value)\r\n\t\t{\r\n\t\t\tif(!string.IsNullOrWhiteSpace(value))\r\n\t\t\t\treturn int.Parse(value, System.Globalization.CultureInfo.InvariantCulture);\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tpublic static string NullableIntegerToString(int? value)\r\n\t\t{\r\n\t\t\tif(value.HasValue)\r\n\t\t\t\treturn value.Value.ToString(System.Globalization.CultureInfo.InvariantCulture);\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tpublic static ValueTuple NullableIntegerToTuple(int? value)\r\n\t\t{\r\n\t\t\treturn value != null ? new ValueTuple(value.Value.ToString(System.Globalization.CultureInfo.InvariantCulture), false, false) : null;\r\n\t\t}\r\n\r\n\t\tpublic static int? ParseNullableInt(TextReader reader, int context)\r\n\t\t{\r\n\t\t\treturn IntConverter.ParseNullable(reader);\r\n\t\t}\r\n\r\n\t\tpublic static List<int?> ParseNullableListInt(TextReader reader, int context)\r\n\t\t{\r\n\t\t\treturn IntConverter.ParseNullableCollection(reader, context);\r\n\t\t}\r\n\t}\r\n}\r\nnamespace _DatabaseCommon\r\n{\r\n\tusing System.Collections.Generic;\r\n\tusing System.IO;\r\n\tusing System.Text;\r\n\tusing NGS.DatabasePersistence.Postgres;\r\n\tusing NGS.DatabasePersistence.Postgres.Converters;\r\n\r\n\tinternal static partial class Utility\r\n\t{\r\n\t\tpublic static int ToInt(this string value)\r\n\t\t{\r\n\t\t\tif(!string.IsNullOrWhiteSpace(value))\r\n\t\t\t\treturn int.Parse(value, System.Globalization.CultureInfo.InvariantCulture);\r\n\t\t\treturn 0;\r\n\t\t}\r\n\r\n\t\tpublic static string IntegerToString(int value)\r\n\t\t{\r\n\t\t\treturn value.ToString(System.Globalization.CultureInfo.InvariantCulture);\r\n\t\t}\r\n\r\n\t\tpublic static ValueTuple IntegerToTuple(int value)\r\n\t\t{\r\n\t\t\treturn new ValueTuple(value.ToString(System.Globalization.CultureInfo.InvariantCulture), false, false);\r\n\t\t}\r\n\r\n\t\tpublic static int ParseInt(TextReader reader, int context)\r\n\t\t{\r\n\t\t\treturn IntConverter.Parse(reader);\r\n\t\t}\r\n\r\n\t\tpublic static List<int> ParseListInt(TextReader reader, int context)\r\n\t\t{\r\n\t\t\treturn IntConverter.ParseCollection(reader, context);\r\n\t\t}\r\n\t}\r\n}","CSharpServer/SystemBoot.Configuration.cs":"\r\nnamespace SystemBoot\r\n{\r\n\tusing System;\r\n\tusing System.Collections.Generic;\r\n\tusing System.Linq;\r\n\tusing System.Linq.Expressions;\r\n\tusing System.Text;\r\n\tusing System.Threading;\r\n\tusing System.Runtime.Serialization;\r\n\tusing NGS;\r\n\tusing NGS.DomainPatterns;\r\n\tusing NGS.Extensibility;\r\n\r\n\tusing NGS.DatabasePersistence.Postgres.Converters;\r\n\r\n\tusing NGS.DatabasePersistence.Postgres;\r\n\r\n\tusing NGS.DatabasePersistence;\r\n\r\n\tusing System.Data;\r\n\r\n\tpublic class Configuration : ISystemAspect\r\n\t{\r\n\t\tprivate static bool IsInitialized;\r\n\r\n\t\tpublic void Initialize(IObjectFactory factory)\r\n\t\t{\r\n\t\t\tif(IsInitialized)\r\n\t\t\t\treturn;\r\n\t\t\tIsInitialized = true;\r\n\r\n\t\t\t{\r\n\t\t\t\tvar dbTranConf = factory.Resolve<NGS.DatabasePersistence.IDatabaseQueryManager>();\r\n\t\t\t\tvar dbQuery = dbTranConf.CreateQuery();\r\n\t\t\t\tvar columnsInfo = dbQuery.Fill(@\"SELECT * FROM \"\"-NGS-\"\".Load_Type_Info()\");\r\n\t\t\t\tcolumnsInfo.CaseSensitive = true;\r\n\t\t\t\tcolumnsInfo.PrimaryKey = new[] { columnsInfo.Columns[0], columnsInfo.Columns[1], columnsInfo.Columns[2] };\r\n\t\t\t\t_DatabaseConfiguration.DatabaseConverters.Initialize(columnsInfo);\r\n\t\t\t\tdbTranConf.EndQuery(dbQuery, false);\r\n\t\t\t}\r\n\t\t\tvar postgresConverter = factory.Resolve<NGS.DatabasePersistence.Postgres.IPostgresConverterRepository>();\r\n\t\t\tpostgresConverter.RegisterConverter(typeof(myModule.A), new _DatabaseCommon.FactorymyModule_A.AConverter());\r\n\t\t\tDatabaseRepositorymyModule.RegisterA.Register(factory);\r\n\t\t}\r\n\t}\r\n}\r\n","CSharpServer/AssemblyInfo.cs":"\r\nusing System.Reflection;\r\nusing System.Runtime.CompilerServices;\r\nusing System.Runtime.InteropServices;\r\nusing System;\r\n\r\n[assembly: AssemblyTitle(\"DSL Platform generated model\")]\r\n[assembly: AssemblyDescription(\"https://dsl-platform.com/\")]\r\n[assembly: AssemblyConfiguration(\"\")]\r\n[assembly: AssemblyCompany(\"N.G.S.\")]\r\n[assembly: AssemblyProduct(\"DSL Platform\")]\r\n[assembly: AssemblyCopyright(\"Copyright Â© DSL Platform 2014\")]\r\n[assembly: AssemblyTrademark(\"\")]\r\n[assembly: AssemblyCulture(\"\")]\r\n[assembly: ComVisible(false)]\r\n[assembly: AssemblyVersion(\"2014.5.8.1805\")]\r\n[assembly: AssemblyFileVersion(\"2014.5.8.1805\")]\r\n[assembly: CLSCompliant(true)]","CSharpServer/myModule.A.cs":"\r\nnamespace myModule\r\n{\r\n\tusing System;\r\n\tusing System.Collections.Generic;\r\n\tusing System.Linq;\r\n\tusing System.Linq.Expressions;\r\n\tusing System.Text;\r\n\tusing System.Threading;\r\n\tusing System.Runtime.Serialization;\r\n\tusing NGS;\r\n\tusing NGS.DomainPatterns;\r\n\tusing NGS.Extensibility;\r\n\r\n\t[Serializable]\r\n\t[DataContract(Namespace=\"\")] public partial class A : System.ICloneable, NGS.DomainPatterns.IEntity, IEquatable<A>, NGS.DomainPatterns.IAggregateRoot, NGS.DomainPatterns.ICacheable, IChangeTracking<A>, NGS.Serialization.IJsonObject\r\n\t{\r\n\r\n\t\tpublic override string ToString()\r\n\t\t{\r\n\r\n\t\t\treturn base.ToString();\r\n\t\t}\r\n\r\n\t\t[System.Runtime.Serialization.OnDeserialized]\r\n\t\tprivate void OnDeserialized(StreamingContext context)\r\n\t\t{\r\n\r\n\t\t\tvar locator = context.Context as IServiceLocator;\r\n\t\t\tif (locator == null) return;\r\n\t\t}\r\n\r\n\t\tinternal long _InternalGetSizeApproximation()\r\n\t\t{\r\n\t\t\tlong size = 5;\r\n\t\t\treturn size;\r\n\t\t}\r\n\r\n\t\tinternal void __InternalPrepareInsert() {}\r\n\t\tinternal void __InternalPrepareUpdate() {}\r\n\t\tinternal void __InternalPrepareDelete() {}\r\n\t\tobject ICloneable.Clone() { return Clone(); }\r\n\r\n\t\tinternal void __ReapplyReferences() {}\r\n\t\t[DataMember] public string URI { get; internal set; }\r\n\r\n\t\tpublic A()\r\n\r\n\t\t{\r\n\r\n\t\t\tthis.URI = Guid.NewGuid().ToString();\r\n\t\t}\r\n\r\n\t\tbool IEquatable<IEntity>.Equals(IEntity obj)\r\n\t\t{\r\n\t\t\tvar other = obj as A;\r\n\t\t\treturn other != null\r\n\r\n\t\t\t\t&& other.ID == this.ID\r\n\t\t\t;\r\n\t\t}\r\n\r\n\t\tpublic override int GetHashCode()\r\n\t\t{\r\n\t\t\treturn this.URI != null ? this.URI.GetHashCode() : base.GetHashCode();\r\n\t\t}\r\n\r\n\t\tpublic A Clone()\r\n\t\t{\r\n\t\t\tvar item = new A\r\n\t\t\t{\r\n\t\t\t\tURI = this.URI,\r\n\r\n\t\t\t\tID = this.ID,\r\n\t\t\t};\r\n\r\n\t\t\treturn item;\r\n\t\t}\r\n\t\t//TODO let's leave it out for now\r\n\t\t//public override bool Equals(object other) { return Equals(other as A); }\r\n\t\tpublic bool Equals(A other)\r\n\t\t{\r\n\t\t\treturn (this as IEquatable<IEntity>).Equals(other)\r\n\t\t\t\t&& other.URI == this.URI\r\n\r\n\t\t\t\t&& other.ID == this.ID\r\n\t\t\t;\r\n\t\t}\r\n\r\n\t\t[DataMember(EmitDefaultValue=false,Name=\"ID\")]\r\n\t\tinternal int _ID  = NumberCounter<A>.GetNextTempInt();\r\n\r\n\t\tpublic int ID\r\n\t\t{\r\n\r\n\t\t\tget\r\n\t\t\t{\r\n\r\n\t\t\t\treturn this._ID;\r\n\t\t\t}\r\n\t\t\tinternal\r\n\t\t\tset\r\n\t\t\t{\r\n\r\n\t\t\t\tthis._ID = value;\r\n\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tDictionary<System.Type, IEnumerable<string>> ICacheable.GetRelationships()\r\n\t\t{\r\n\r\n\t\t\tvar result = new List<KeyValuePair<System.Type, string>>();\r\n\r\n\t\t\treturn result.GroupBy(it => it.Key).ToDictionary(it => it.Key, it => it.Select(e => e.Value));\r\n\r\n\t\t}\r\n\r\n\t\tpublic static event Action<A> Validating = a => {};\r\n\t\tpublic void Validate()\r\n\t\t{\r\n\t\t\tValidating(this);\r\n\t\t}\r\n\r\n\t\tinternal A __OriginalValue;\r\n\t\tA IChangeTracking<A>.GetOriginalValue()\r\n\t\t{\r\n\t\t\treturn __OriginalValue;\r\n\t\t}\r\n\r\n\t\tvoid global::NGS.Serialization.IJsonObject.Serialize(System.IO.StreamWriter sw, Action<System.IO.StreamWriter, object> serializer)\r\n\t\t{\r\n\r\n\t\t\tsw.Write('{');\r\n\t\t\t__SerializeJsonObject(sw, new char[36], serializer, false);\r\n\t\t\tsw.Write('}');\r\n\t\t}\r\n\r\n\t\tinternal void __SerializeJsonObject(System.IO.StreamWriter sw, char[] buffer, Action<System.IO.StreamWriter, object> serializer, bool hasWrittenProperty = false)\r\n\t\t{\r\n\r\n\t\t\tif(hasWrittenProperty) sw.Write(',');\r\n\t\t\tsw.Write(\"\\\"URI\\\":\");\r\n\t\t\tglobal::NGS.Serialization.Json.Converters.StringConverter.Serialize(URI, sw);\r\n\r\n\t\t\t\tvar __expID = this.ID;\r\n\t\t\t\tif (__expID != default(int))\r\n\t\t\t\t{\r\n\t\t\t\t\tsw.Write(\",\\\"ID\\\":\");\r\n\t\t\t\t\tglobal::NGS.Serialization.Json.Converters.NumberConverter.Serialize(__expID, sw, buffer);\r\n\t\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n}\r\n","CSharpServer/_DatabaseConfiguration.DatabaseConverters.cs":"\r\nnamespace _DatabaseConfiguration\r\n{\r\n\tusing System;\r\n\tusing System.Collections.Generic;\r\n\tusing System.Linq;\r\n\tusing System.Linq.Expressions;\r\n\tusing System.Text;\r\n\tusing System.Threading;\r\n\tusing System.Runtime.Serialization;\r\n\tusing NGS;\r\n\tusing NGS.DomainPatterns;\r\n\tusing NGS.Extensibility;\r\n\r\n\tinternal partial class DatabaseConverters\r\n\t{\r\n\r\n\t\tinternal static void Initialize(System.Data.DataTable columnsInfo)\r\n\t\t{\r\n\r\n\t\t\tSystem.Data.DataRow row = null;\r\n\t\t\t_DatabaseCommon.FactorymyModule_A.AConverter.InitializeProperties(columnsInfo);\r\n\t\t}\r\n\t}\r\n\r\n}\r\n","CSharpServer/_DatabaseCommon.FactorymyModule_A.AConverter.cs":"\r\nnamespace _DatabaseCommon.FactorymyModule_A\r\n{\r\n\tusing System;\r\n\tusing System.Collections.Generic;\r\n\tusing System.Linq;\r\n\tusing System.Linq.Expressions;\r\n\tusing System.Text;\r\n\tusing System.Threading;\r\n\tusing System.Runtime.Serialization;\r\n\tusing NGS;\r\n\tusing NGS.DomainPatterns;\r\n\tusing NGS.Extensibility;\r\n\r\n\tusing System.Globalization;\r\n\tusing System.IO;\r\n\tusing NGS.DatabasePersistence;\r\n\tusing NGS.DatabasePersistence.Postgres;\r\n\tusing NGS.DatabasePersistence.Postgres.Converters;\r\n\tusing NGS.DomainPatterns;\r\n\tusing NGS.Utility;\r\n\r\n\tinternal class AConverter : IPostgresTypeConverter\r\n\t{\r\n\t\tpublic object CreateInstance(object value, IServiceLocator locator)\r\n\t\t{\r\n\t\t\tif (value == null)\r\n\t\t\t\treturn null;\r\n\t\t\tusing(var sr = value as System.IO.TextReader ?? new System.IO.StringReader(value as string ?? value.ToString()))\r\n\t\t\t{\r\n\t\t\t\treturn CreateFromRecord(sr, 0, locator);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tpublic PostgresTuple ToTuple(object instance)\r\n\t\t{\r\n\t\t\treturn CreateTupleFrom(instance as myModule.A);\r\n\t\t}\r\n\r\n\t\tpublic static RecordTuple CreateExtendedTupleFrom(myModule.A item)\r\n\t\t{\r\n\t\t\tif(item == null)\r\n\t\t\t\treturn null;\r\n\r\n\t\t\tvar items = new PostgresTuple[ExtendedColumnCount];\r\n\r\n\t\t\titems[ExtendedProperty_URI_Index] = new ValueTuple(item.URI);\r\n\t\t\titems[ExtendedProperty_ID_Index] = _DatabaseCommon.Utility.IntegerToTuple(item.ID);\r\n\t\t\treturn new RecordTuple(items);\r\n\t\t}\r\n\r\n\t\tpublic static RecordTuple CreateTupleFrom(myModule.A item)\r\n\t\t{\r\n\t\t\tif(item == null)\r\n\t\t\t\treturn null;\r\n\r\n\t\t\tvar items = new PostgresTuple[ColumnCount];\r\n\r\n\t\t\titems[Property_URI_Index] = new ValueTuple(item.URI);\r\n\t\t\titems[Property_ID_Index] = _DatabaseCommon.Utility.IntegerToTuple(item.ID);\r\n\t\t\treturn new RecordTuple(items);\r\n\t\t}\r\n\r\n\t\tprivate static int ColumnCount;\r\n\t\tprivate static int ExtendedColumnCount;\r\n\r\n\t\tinternal static void InitializeProperties(System.Data.DataTable columnsInfo)\r\n\t\t{\r\n\t\t\tSystem.Data.DataRow row = null;\r\n\r\n\t\t\tColumnCount = columnsInfo.Select(\"type_schema = 'myModule' AND type_name = 'A_entity'\").Length;\r\n\t\t\tExtendedColumnCount = columnsInfo.Select(\"type_schema = 'myModule' AND type_name = '-ngs_A_type-'\").Length;\r\n\r\n\t\t\tReaderConfiguration = new Action<myModule.A, TextReader, int, IServiceLocator>[ColumnCount > 0 ? ColumnCount : 1];\r\n\t\t\tReaderExtendedConfiguration = new Action<myModule.A, TextReader, int, IServiceLocator>[ExtendedColumnCount > 0 ? ExtendedColumnCount : 1];\r\n\t\t\tfor(int i = 0;i < ColumnCount; i++)\r\n\t\t\t\tReaderConfiguration[i] = (agg, tr, c, sl) => StringConverter.Skip(tr, c);\r\n\t\t\tif(ColumnCount != ReaderConfiguration.Length)\r\n\t\t\t\tReaderConfiguration[0] = (agg, tr, c, sl) => tr.Read();\r\n\t\t\tfor(int i = 0;i < ExtendedColumnCount; i++)\r\n\t\t\t\tReaderExtendedConfiguration[i] = (agg, tr, c, sl) => StringConverter.Skip(tr, c);\r\n\t\t\tif(ExtendedColumnCount != ReaderExtendedConfiguration.Length)\r\n\t\t\t\tReaderExtendedConfiguration[0] = (agg, tr, c, sl) => tr.Read();\r\n\r\n\t\t\trow = columnsInfo.Rows.Find(new[] { \"myModule\", \"A_entity\", \"URI\" });\r\n\t\t\tif(row == null)\r\n\t\t\t\tthrow new System.Configuration.ConfigurationException(\"Couldn't find column URI in type myModule.A_entity. Check if database is out of sync with code\");\r\n\t\t\tProperty_URI_Index = (short)row[\"column_index\"] - 1;\r\n\r\n\t\t\trow = columnsInfo.Rows.Find(new[] { \"myModule\", \"-ngs_A_type-\", \"URI\" });\r\n\t\t\tif(row == null)\r\n\t\t\t\tthrow new System.Configuration.ConfigurationException(\"Couldn't find column URI in type myModule.A. Check if database is out of sync with code\");\r\n\t\t\tExtendedProperty_URI_Index = (short)row[\"column_index\"] - 1;\r\n\r\n\t\t\tReaderConfiguration[Property_URI_Index] = (item, reader, context, locator) => item.URI = StringConverter.Parse(reader, context);\r\n\r\n\t\t\tReaderExtendedConfiguration[ExtendedProperty_URI_Index] = (item, reader, context, locator) => item.URI = StringConverter.Parse(reader, context);\r\n\r\n\t\t\trow = columnsInfo.Rows.Find(new[] { \"myModule\", \"A_entity\", \"ID\" });\r\n\t\t\tif(row == null)\r\n\t\t\t\tthrow new System.Configuration.ConfigurationException(\"Couldn't find column ID in type myModule.A_entity. Check if database is out of sync with code\");\r\n\t\t\tProperty_ID_Index = (short)row[\"column_index\"] - 1;\r\n\r\n\t\t\tReaderConfiguration[Property_ID_Index] = (item, reader, context, locator) => item._ID = _DatabaseCommon.Utility.ParseInt(reader, context);\r\n\r\n\t\t\trow = columnsInfo.Rows.Find(new[] { \"myModule\", \"-ngs_A_type-\", \"ID\" });\r\n\t\t\tif(row == null)\r\n\t\t\t\tthrow new System.Configuration.ConfigurationException(\"Couldn't find column ID in type myModule.A. Check if database is out of sync with code\");\r\n\t\t\tExtendedProperty_ID_Index = (short)row[\"column_index\"] - 1;\r\n\r\n\t\t\tReaderExtendedConfiguration[ExtendedProperty_ID_Index] = (item, reader, context, locator) => item._ID = _DatabaseCommon.Utility.ParseInt(reader, context);\r\n\r\n\t\t}\r\n\r\n\t\tprivate static Action<myModule.A, TextReader, int, IServiceLocator>[] ReaderConfiguration;\r\n\t\tprivate static Action<myModule.A, TextReader, int, IServiceLocator>[] ReaderExtendedConfiguration;\r\n\r\n\t\tpublic static myModule.A CreateFromRecord(TextReader reader, int context, IServiceLocator locator)\r\n\t\t{\r\n\t\t\tvar cur = reader.Read();\r\n\t\t\tif (cur == ',' || cur == ')')\r\n\t\t\t\treturn null;\r\n\t\t\tvar result = CreateFromRecord(reader, context, context == 0 ? 1 : context << 1, locator);\r\n\t\t\treader.Read();\r\n\t\t\treturn result;\r\n\t\t}\r\n\r\n\t\tpublic static myModule.A CreateFromRecord(TextReader reader, int outerContext, int context, IServiceLocator locator)\r\n\t\t{\r\n\t\t\tfor (int i = 0; i < outerContext; i++)\r\n\t\t\t\treader.Read();\r\n\t\t\tvar item = new myModule.A();\r\n\t\t\tforeach (var config in ReaderConfiguration)\r\n\t\t\t\tconfig(item, reader, context, locator);\r\n\t\t\tfor (int i = 0; i < outerContext; i++)\r\n\t\t\t\treader.Read();\r\n\r\n\t\t\titem.__OriginalValue = item.Clone();\r\n\t\t\treturn item;\r\n\t\t}\r\n\r\n\t\tpublic static myModule.A CreateFromExtendedRecord(TextReader reader, int context, IServiceLocator locator)\r\n\t\t{\r\n\t\t\tvar cur = reader.Read();\r\n\t\t\tif (cur == ',' || cur == ')')\r\n\t\t\t\treturn null;\r\n\t\t\tvar result = CreateFromExtendedRecord(reader, context, context == 0 ? 1 : context << 1, locator);\r\n\t\t\treader.Read();\r\n\t\t\treturn result;\r\n\t\t}\r\n\r\n\t\tpublic static myModule.A CreateFromExtendedRecord(TextReader reader, int outerContext, int context, IServiceLocator locator)\r\n\t\t{\r\n\t\t\tfor (int i = 0; i < outerContext; i++)\r\n\t\t\t\treader.Read();\r\n\t\t\tvar item = new myModule.A();\r\n\t\t\tforeach (var config in ReaderExtendedConfiguration)\r\n\t\t\t\tconfig(item, reader, context, locator);\r\n\t\t\tfor (int i = 0; i < outerContext; i++)\r\n\t\t\t\treader.Read();\r\n\r\n\t\t\titem.__OriginalValue = item.Clone();\r\n\t\t\treturn item;\r\n\t\t}\r\n\r\n\t\tprivate static int Property_URI_Index;\r\n\t\tprivate static int ExtendedProperty_URI_Index;\r\n\t\tinternal static List<int> OptionalEntityReferences = new List<int>();\r\n\t\tprivate static int Property_ID_Index;\r\n\t\tprivate static int ExtendedProperty_ID_Index;\r\n\r\n\t\tinternal static string BuildURI(int ID)\r\n\t\t{\r\n\t\t\treturn _DatabaseCommon.Utility.IntegerToString(ID);\r\n\t\t}\r\n\r\n\t\tinternal static void ParseURI(IServiceLocator locator, string URI, out int ID)\r\n\t\t{\r\n\r\n\t\t\tID = _DatabaseCommon.Utility.ToInt(URI);\r\n\t\t}\r\n\t}\r\n}\r\n","CSharpServer/DatabaseRepositorymyModule.ARepository.cs":"\r\nnamespace DatabaseRepositorymyModule\r\n{\r\n\tusing System;\r\n\tusing System.Collections.Generic;\r\n\tusing System.Linq;\r\n\tusing System.Linq.Expressions;\r\n\tusing System.Text;\r\n\tusing System.Threading;\r\n\tusing System.Runtime.Serialization;\r\n\tusing NGS;\r\n\tusing NGS.DomainPatterns;\r\n\tusing NGS.Extensibility;\r\n\r\n\tusing NGS.Utility;\r\n\tusing System.IO;\r\n\r\n\tusing NGS.DatabasePersistence;\r\n\tusing NGS.DatabasePersistence.Postgres;\r\n\tusing NGS.DatabasePersistence.Postgres.Converters;\r\n\tusing NGS.DatabasePersistence.Postgres.QueryGeneration;\r\n\r\n\tinternal static class RegisterA\r\n\t{\r\n\t\tpublic static void Register(IObjectFactory factory)\r\n\t\t{\r\n\t\t\tfactory.RegisterType(typeof(DatabaseRepositorymyModule.ARepository));\r\n\t\t\tfactory.RegisterType(typeof(DatabaseRepositorymyModule.ARepository), typeof(IQueryableRepository<myModule.A>), InstanceScope.Context);\r\n\t\t\tfactory.RegisterFunc<IQueryable<myModule.A>>(f => f.Resolve<IQueryableRepository<myModule.A>>().Query<myModule.A>(null));\r\n\r\n\t\t\tfactory.RegisterType(typeof(DatabaseRepositorymyModule.ARepository), typeof(IRepository<myModule.A>), InstanceScope.Context);\r\n\t\t\tfactory.RegisterFunc<Func<string, myModule.A>>(f => f.Resolve<IRepository<myModule.A>>().Find);\r\n\t\t\tfactory.RegisterFunc<Func<IEnumerable<string>, myModule.A[]>>(f => f.Resolve<IRepository<myModule.A>>().Find);\r\n\t\t\tfactory.RegisterType(typeof(DatabaseRepositorymyModule.ARepository), typeof(IPersistableRepository<myModule.A>), InstanceScope.Context);\r\n\t\t\tfactory.RegisterType(typeof(DatabaseRepositorymyModule.ARepository), typeof(IPersistableRepository<myModule.A>), InstanceScope.Context);\r\n\t\t\tfactory.RegisterType(typeof(DatabaseRepositorymyModule.ARepository), typeof(IAggregateRootRepository<myModule.A>), InstanceScope.Context);\r\n\r\n\t\t}\r\n\t}\r\n\r\n\tinternal partial class ARepository : IQueryableRepository<myModule.A>, System.IDisposable, IRepository<myModule.A>, IPersistableRepository<myModule.A>, IAggregateRootRepository<myModule.A>\r\n\t{\r\n\r\n\t\tprivate readonly IServiceLocator Locator;\r\n\t\tprivate readonly IDatabaseQuery DatabaseQuery;\r\n\r\n\t\tpublic ARepository(IServiceLocator locator, IDatabaseQuery query, IEagerNotification Notifications)\r\n\r\n\t\t{\r\n\r\n\t\t\tthis.Locator = locator;\r\n\t\t\tthis.DatabaseQuery = query;\r\n\r\n\t\t\tthis.Notifications = Notifications;\r\n\t\t\tDataCache = new WeakCache<myModule.A>(this);\r\n\t\t}\r\n\r\n\t\tpublic void Dispose()\r\n\t\t{\r\n\r\n\t\t\tif (!DatabaseQuery.InTransaction)\r\n\t\t\t{\r\n\t\t\t\tNotifyInfo ni;\r\n\t\t\t\twhile (NotifyQueue.TryDequeue(out ni))\r\n\t\t\t\t\tNotifications.Notify(ni);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tpublic IQueryable<myModule.A> Query<TCondition>(ISpecification<TCondition> specification)\r\n\t\t{\r\n\t\t\tif(specification != null && specification.IsSatisfied == null)\r\n\t\t\t\tthrow new ArgumentException(\"Search predicate is not specified\");\r\n\t\t\tif(specification != null && !typeof(TCondition).IsAssignableFrom(typeof(myModule.A)))\r\n\t\t\t\tthrow new ArgumentException(\"Specification is not compatible\");\r\n\r\n\t\t\tIQueryable<myModule.A> data = new Queryable<myModule.A>(new QueryExecutor(DatabaseQuery, Locator));\r\n\t\t\tbool rewritten = false;\r\n\r\n\t\t\tif(!rewritten && specification != null)\r\n\t\t\t{\r\n\t\t\t\tvar specAsNative = specification as ISpecification<myModule.A>;\r\n\t\t\t\tif(specAsNative != null)\r\n\t\t\t\t\tdata = data.Where(specAsNative.IsSatisfied);\r\n\t\t\t\telse\r\n\t\t\t\t\tdata = data.Cast<TCondition>().Where(specification.IsSatisfied).Cast<myModule.A>();\r\n\t\t\t}\r\n\r\n\t\t\treturn data;\r\n\t\t}\r\n\r\n\t\tpublic myModule.A[] Search<TCondition>(ISpecification<TCondition> specification, int? limit, int? offset)\r\n\t\t{\r\n\t\t\tif(specification != null && specification.IsSatisfied == null)\r\n\t\t\t\tthrow new ArgumentException(\"Search predicate is not specified\");\r\n\r\n\t\t\tbool rewritten = false;\r\n\t\t\tvar result = new List<myModule.A>();\r\n\r\n\t\t\tif(!rewritten)\r\n\t\t\t{\r\n\t\t\t\tvar query = Query(specification);\r\n\t\t\t\tif (limit != null && limit.Value >= 0)\r\n\t\t\t\t\tquery = query.Take(limit.Value);\r\n\t\t\t\tif (offset != null && offset.Value >= 0)\r\n\t\t\t\t\tquery = query.Skip(offset.Value);\r\n\t\t\t\tresult.AddRange(query);\r\n\t\t\t}\r\n\r\n\t\t\treturn result.ToArray();\r\n\t\t}\r\n\r\n\t\tpublic myModule.A[] Find(IEnumerable<string> uris)\r\n\t\t{\r\n\t\t\tif(uris == null || !uris.Any(it => it != null))\r\n\t\t\t\treturn new myModule.A[0];\r\n\r\n\t\t\tvar pks = uris.Where(it => it != null).ToList();\r\n\t\t\tvar formattedUris = NGS.DatabasePersistence.Postgres.PostgresRecordConverter.BuildSimpleUriList(pks);\r\n\t\t\tvar result = new List<myModule.A>(pks.Count);\r\n\t\t\tDatabaseQuery.Execute(\r\n\t\t\t\t@\"SELECT r FROM \"\"myModule\"\".\"\"A_entity\"\" r WHERE r.\"\"ID\"\" IN (\" + formattedUris + \")\",\r\n\t\t\t\tdr =>\r\n\t\t\t\t{\r\n\t\t\t\t\tvar _pg = dr.GetValue(0);\r\n\t\t\t\t\tusing(var _tr = _pg as System.IO.TextReader ?? new System.IO.StringReader(_pg as string))\r\n\t\t\t\t\t\tresult.Add(_DatabaseCommon.FactorymyModule_A.AConverter.CreateFromRecord(_tr, 0, Locator));\r\n\t\t\t\t});\r\n\r\n\t\t\treturn result.ToArray();\r\n\t\t}\r\n\r\n\t\tprivate readonly WeakCache<myModule.A> DataCache;\r\n\t\tprivate readonly System.Collections.Concurrent.ConcurrentQueue<NotifyInfo> NotifyQueue = new System.Collections.Concurrent.ConcurrentQueue<NotifyInfo>();\r\n\t\tprivate readonly IEagerNotification Notifications;\r\n\r\n\t\tpublic string[] Persist(IEnumerable<myModule.A> insert, IEnumerable<KeyValuePair<myModule.A, myModule.A>> update, IEnumerable<myModule.A> delete)\r\n\t\t{\r\n\t\t\tvar insertedData = insert != null ? insert.ToArray() : new myModule.A[0];\r\n\t\t\tvar updatedData = update != null ? update.ToList() : new List<KeyValuePair<myModule.A, myModule.A>>();\r\n\t\t\tvar deletedData = delete != null ? delete.ToArray() : new myModule.A[0];\r\n\r\n\t\t\tif(insertedData.Length == 0 && updatedData.Count == 0 && deletedData.Length == 0)\r\n\t\t\t\treturn new string[0];\r\n\r\n\t\t\tif (updatedData.Count > 0 && updatedData.Any(it => it.Key == null))\r\n\t\t\t{\r\n\t\t\t\t//TODO fetch only null values\r\n\t\t\t\tvar oldValues = Find(updatedData.Select(it => it.Value.URI)).ToDictionary(it => it.URI);\r\n\t\t\t\tif (oldValues.Count != updatedData.Count)\r\n\t\t\t\t\tthrow new ArgumentException(\"Can't find update value. Requested: {0}, found: {1}. Missing: {2}\".With(\r\n\t\t\t\t\t\tupdatedData.Count,\r\n\t\t\t\t\t\toldValues.Count,\r\n\t\t\t\t\t\tstring.Join(\", \", updatedData.Select(it => it.Value.URI).Except(oldValues.Keys))));\r\n\t\t\t\tmyModule.A _val;\r\n\t\t\t\tfor(int i = 0; i < updatedData.Count; i++)\r\n\t\t\t\t{\r\n\t\t\t\t\t_val = updatedData[i].Value;\r\n\t\t\t\t\tupdatedData[i] = new KeyValuePair<myModule.A, myModule.A>(oldValues[_val.URI], _val);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tupdatedData.RemoveAll(kv => kv.Key.Equals(kv.Value));\r\n\r\n\t\t\tDatabaseQuery.Fill<myModule.A, int>(insertedData, @\"nextval('\"\"myModule\"\".\"\"A_ID_seq\"\"'::regclass)::int\", (it, seq) => it.ID = seq);\r\n\r\n\t\t\tforeach(var it in insertedData)\r\n\t\t\t\tit.Validate();\r\n\t\t\tforeach(var it in updatedData)\r\n\t\t\t\tit.Value.Validate();\r\n\t\t\tforeach(var it in deletedData)\r\n\t\t\t\tit.Validate();\r\n\t\t\tfor(int i = 0; i < insertedData.Length; i++)\r\n\t\t\t\tinsertedData[i].__InternalPrepareInsert();\r\n\t\t\tforeach(var it in updatedData)\r\n\t\t\t\tit.Value.__InternalPrepareUpdate();\r\n\t\t\tfor(int i = 0; i < deletedData.Length; i++)\r\n\t\t\t\tdeletedData[i].__InternalPrepareDelete();\r\n\r\n\t\t\tfor(int i = 0; i < insertedData.Length; i++)\r\n\t\t\t{\r\n\t\t\t\tvar it = insertedData[i];\r\n\r\n\t\t\t\tit.URI = _DatabaseCommon.FactorymyModule_A.AConverter.BuildURI(it.ID);\r\n\t\t\t}\r\n\t\t\tforeach(var kv in updatedData)\r\n\t\t\t{\r\n\r\n\t\t\t\tkv.Value.URI = _DatabaseCommon.FactorymyModule_A.AConverter.BuildURI(kv.Value.ID);\r\n\t\t\t}\r\n\r\n\t\t\t_InternalDoPersist(insertedData, updatedData, deletedData);\r\n\t\t\tvar resultURI = new string[insertedData.Length];\r\n\t\t\tfor(int i = 0; i < resultURI.Length; i++)\r\n\t\t\t\tresultURI[i] = insertedData[i].URI;\r\n\r\n\t\t\tif (DatabaseQuery.InTransaction)\r\n\t\t\t{\r\n\t\t\t\tif (insertedData.Length > 0) NotifyQueue.Enqueue(new NotifyInfo(\"myModule.A\", NotifyInfo.OperationEnum.Insert, resultURI));\r\n\t\t\t\tif (updatedData.Count > 0)\r\n\t\t\t\t{\r\n\t\t\t\t\tNotifyQueue.Enqueue(new NotifyInfo(\"myModule.A\", NotifyInfo.OperationEnum.Update, updatedData.Select(it => it.Key.URI).ToArray()));\r\n\t\t\t\t\tif (updatedData.Any(kv => kv.Key.URI != kv.Value.URI)) NotifyQueue.Enqueue(new NotifyInfo(\"myModule.A\", NotifyInfo.OperationEnum.Change, updatedData.Where(kv => kv.Key.URI != kv.Value.URI).Select(it => it.Value.URI).ToArray()));\r\n\t\t\t\t}\r\n\t\t\t\tif (deletedData.Length > 0) NotifyQueue.Enqueue(new NotifyInfo(\"myModule.A\", NotifyInfo.OperationEnum.Delete, deletedData.Select(it => it.URI).ToArray()));\r\n\t\t\t\tDataCache.Invalidate(updatedData.Select(it => it.Key.URI).Union(deletedData.Select(it => it.URI)));\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tif (insertedData.Length > 0) Notifications.Notify(new NotifyInfo(\"myModule.A\", NotifyInfo.OperationEnum.Insert, resultURI));\r\n\t\t\t\tif (updatedData.Count > 0)\r\n\t\t\t\t{\r\n\t\t\t\t\tNotifications.Notify(new NotifyInfo(\"myModule.A\", NotifyInfo.OperationEnum.Update, updatedData.Select(it => it.Key.URI).ToArray()));\r\n\t\t\t\t\tif (updatedData.Any(kv => kv.Key.URI != kv.Value.URI)) Notifications.Notify(new NotifyInfo(\"myModule.A\", NotifyInfo.OperationEnum.Change, updatedData.Where(kv => kv.Key.URI != kv.Value.URI).Select(it => it.Value.URI).ToArray()));\r\n\t\t\t\t}\r\n\t\t\t\tif (deletedData.Length > 0) Notifications.Notify(new NotifyInfo(\"myModule.A\", NotifyInfo.OperationEnum.Delete, deletedData.Select(it => it.URI).ToArray()));\r\n\t\t\t}\r\n\r\n\t\t\treturn resultURI;\r\n\t\t}\r\n\r\n\t\tprivate readonly IPostgresTypeConverter TypeConverter = new _DatabaseCommon.FactorymyModule_A.AConverter();\r\n\r\n\t\tprivate void _InternalDoPersist(myModule.A[] insertedData, List<KeyValuePair<myModule.A, myModule.A>> updatedData, myModule.A[] deletedData)\r\n\t\t{\r\n\t\t\tusing(var cms = ChunkedMemoryStream.Create())\r\n\t\t\t{\r\n\t\t\t\tvar sw = cms.GetWriter();\r\n\t\t\t\tsw.Write(\"SELECT \\\"myModule\\\".\\\"persist_A\\\"(\");\r\n\t\t\t\tPostgresTypedArray.ToArray(sw, insertedData, _DatabaseCommon.FactorymyModule_A.AConverter.CreateTupleFrom);\r\n\t\t\t\tsw.Write(@\"::\"\"myModule\"\".\"\"A_entity\"\"[],\");\r\n\t\t\t\tPostgresTypedArray.ToArray(sw, updatedData.Select(it => it.Key), _DatabaseCommon.FactorymyModule_A.AConverter.CreateTupleFrom);\r\n\t\t\t\tsw.Write(@\"::\"\"myModule\"\".\"\"A_entity\"\"[],\");\r\n\t\t\t\tPostgresTypedArray.ToArray(sw, updatedData.Select(it => it.Value), _DatabaseCommon.FactorymyModule_A.AConverter.CreateTupleFrom);\r\n\t\t\t\tsw.Write(@\"::\"\"myModule\"\".\"\"A_entity\"\"[],\");\r\n\t\t\t\tPostgresTypedArray.ToArray(sw, deletedData, _DatabaseCommon.FactorymyModule_A.AConverter.CreateTupleFrom);\r\n\t\t\t\tsw.Write(@\"::\"\"myModule\"\".\"\"A_entity\"\"[]\");\r\n\r\n\t\t\t\tsw.Write(\")\");\r\n\r\n\t\t\t\tsw.Flush();\r\n\t\t\t\tcms.Position = 0;\r\n\t\t\t\tvar com = new Npgsql.NpgsqlCommand(cms);\r\n\t\t\t\tDatabaseQuery.Execute(com);\r\n\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tmyModule.A[] IAggregateRootRepository<myModule.A>.Create(int count, Action<myModule.A[]> initialize)\r\n\t\t{\r\n\t\t\tif(count < 0)\r\n\t\t\t\tthrow new ArgumentException(\"count must be positive: Provided value \" + count);\r\n\t\t\tvar roots = new myModule.A[count];\r\n\t\t\tfor(int i = 0; i < count; i++)\r\n\t\t\t\troots[i] = new myModule.A();\r\n\t\t\tif(initialize != null)\r\n\t\t\t\tinitialize(roots);\r\n\t\t\tPersist(roots, null, null);\r\n\t\t\treturn roots;\r\n\t\t}\r\n\r\n\t\tmyModule.A[] IAggregateRootRepository<myModule.A>.Update(string[] uris, Action<myModule.A[]> change)\r\n\t\t{\r\n\t\t\tvar roots = Find(uris);\r\n\t\t\tif(roots.Length != uris.Length)\r\n\t\t\t\tthrow new ArgumentException(\"Can't find myModule.A with uri: \".With(string.Join(\", \", uris)));\r\n\t\t\tif(change != null)\r\n\t\t\t{\r\n\t\t\t\tvar originals = roots.Select(it => it.Clone()).ToDictionary(it => it.URI);\r\n\t\t\t\tchange(roots);\r\n\t\t\t\tPersist(null, roots.Select(it => new KeyValuePair<myModule.A, myModule.A>(originals[it.URI], it)).ToList(), null);\r\n\t\t\t}\r\n\t\t\treturn roots;\r\n\t\t}\r\n\r\n\t\tvoid IAggregateRootRepository<myModule.A>.Delete(string[] uris)\r\n\t\t{\r\n\t\t\tvar roots = Find(uris);\r\n\t\t\tif(roots.Length != uris.Length)\r\n\t\t\t\tthrow new ArgumentException(\"Can't find myModule.A with uri: \".With(string.Join(\", \", uris)));\r\n\t\t\tPersist(null, null, roots);\r\n\t\t}\r\n\r\n\t\tIQueryable<myModule.A> IQueryableRepository<myModule.A>.Query<TCondition>(ISpecification<TCondition> specification)\r\n\t\t{\r\n\t\t\treturn Query(specification);\r\n\t\t}\r\n\r\n\t\tmyModule.A[] IQueryableRepository<myModule.A>.Search<TCondition>(ISpecification<TCondition> specification, int? limit, int? offset)\r\n\t\t{\r\n\t\t\treturn Search(specification, limit, offset);\r\n\t\t}\r\n\r\n\t\tmyModule.A[] IRepository<myModule.A>.Find(IEnumerable<string> uris) { return Find(uris); }\r\n\t}\r\n\r\n}\r\n","Java/namespace.Guards.java":"package namespace;\r\n\r\nimport java.util.*;\r\nimport java.math.BigDecimal;\r\n\r\npublic final class Guards   {\r\n\r\n\tpublic static <T> void checkNulls(final Iterable<T> values) {\r\n\t\tif (values == null) return;\r\n\r\n\t\tint i = 0;\r\n\t\tfor (final T value: values) {\r\n\t\t\tif (value == null) throw new IllegalArgumentException(\"Element at index \" + i + \" was a null value, which is not permitted.\");\r\n\t\t\ti++;\r\n\t\t}\r\n\t}\r\n\r\n\tpublic static <T> void checkNulls(final T[] values) {\r\n\t\tif (values == null) return;\r\n\r\n\t\tint i = 0;\r\n\t\tfor (final T value: values) {\r\n\t\t\tif (value == null) throw new IllegalArgumentException(\"Element at index \" + i + \" was a null value, which is not permitted.\");\r\n\t\t\ti++;\r\n\t\t}\r\n\t}\r\n\r\n\tpublic static void checkScale(final BigDecimal value, final int scale) {\r\n\t\ttry {\r\n\t\t\tif (value != null) value.setScale(scale);\r\n\t\t}\r\n\t\tcatch(final ArithmeticException e) {\r\n\t\t\tthrow new IllegalArgumentException(\r\n\t\t\t\t\t\"Decimal places allowed: \" + scale + \". Value: \" + value, e);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic static void checkScale(final BigDecimal[] values, final int scale) {\r\n\t\tif (values == null) return;\r\n\r\n\t\tint i = 0;\r\n\t\tfor (final BigDecimal value: values) {\r\n\t\t\ttry {\r\n\t\t\t\tif (value != null) value.setScale(scale);\r\n\t\t\t}\r\n\t\t\tcatch(final ArithmeticException e) {\r\n\t\t\t\tthrow new IllegalArgumentException(\r\n\t\t\t\t\t\t\"Invalid value for element at index \" + i + \". Decimal places allowed: \" + scale + \". Value: \" + value, e);\r\n\t\t\t}\r\n\r\n\t\t\ti++;\r\n\t\t}\r\n\t}\r\n\r\n\tpublic static void checkScale(final Iterable<BigDecimal> values, final int scale) {\r\n\t\tif (values == null) return;\r\n\r\n\t\tint i = 0;\r\n\t\tfor (final BigDecimal value: values) {\r\n\t\t\ttry {\r\n\t\t\t\tif (value != null) value.setScale(scale);\r\n\t\t\t}\r\n\t\t\tcatch(final ArithmeticException e) {\r\n\t\t\t\tthrow new IllegalArgumentException(\r\n\t\t\t\t\t\t\"Invalid value for element at index \" + i + \". Decimal places allowed: \" + scale + \". Value: \" + value, e);\r\n\t\t\t}\r\n\r\n\t\t\ti++;\r\n\t\t}\r\n\t}\r\n\r\n\tpublic static BigDecimal setScale(final BigDecimal value, final int scale) {\r\n\t\treturn value.setScale(scale, BigDecimal.ROUND_HALF_UP);\r\n\t}\r\n\r\n\tpublic static List<BigDecimal> setScale(final List<BigDecimal> values, final int scale) {\r\n\t\tif (values == null) return null;\r\n\r\n\t\tfinal ArrayList<BigDecimal> result = new ArrayList<BigDecimal>(values.size());\r\n\t\tfor (final BigDecimal value: values) result.add(value != null ? setScale(value, scale) : null);\r\n\t\treturn result;\r\n\t}\r\n\r\n\tpublic static Set<BigDecimal> setScale(final Set<BigDecimal> values, final int scale) {\r\n\t\tif (values == null) return null;\r\n\r\n\t\tfinal HashSet<BigDecimal> result = new HashSet<BigDecimal>(values.size());\r\n\t\tfor (final BigDecimal value: values) result.add(value != null ? setScale(value, scale) : null);\r\n\t\treturn result;\r\n\t}\r\n\r\n\tpublic static BigDecimal[] setScale(final BigDecimal[] values, final int scale) {\r\n\t\tif (values == null) return null;\r\n\r\n\t\tfinal BigDecimal[] result = new BigDecimal[values.length];\r\n\t\tint i = 0;\r\n\t\tfor (final BigDecimal value: values) result[i++] = value != null ? setScale(value, scale) : null;\r\n\t\treturn result;\r\n\t}\r\n\r\n\tpublic static void checkLength(final String value, final int length) {\r\n\t\tif (value != null && value.length() > length) throw new IllegalArgumentException(\r\n\t\t\t\t\"Maximum length allowed: \" + length +\". Value: \" + value);\r\n\t}\r\n\r\n\tpublic static void checkLength(final Iterable<String> values, final int length) {\r\n\t\tif (values == null) return;\r\n\r\n\t\tint i = 0;\r\n\t\tfor (final String value: values) {\r\n\t\t\tif (value != null && value.length() > length) throw new IllegalArgumentException(\r\n\t\t\t\t\t\"Invalid value for element at index \" + i + \". Maximum length allowed: \" + length +\". Value: \" + value);\r\n\t\t\ti++;\r\n\t\t}\r\n\t}\r\n\r\n\tpublic static void checkLength(final String[] values, final int length) {\r\n\t\tif (values == null) return;\r\n\r\n\t\tint i = 0;\r\n\t\tfor (final String value: values) {\r\n\t\t\tif (value != null && value.length() > length) throw new IllegalArgumentException(\r\n\t\t\t\t\t\"Invalid value for element at index \" + i + \". Maximum length allowed: \" + length +\". Value: \" + value);\r\n\t\t\ti++;\r\n\t\t}\r\n\t}\r\n\r\n\tpublic static boolean compareBigDecimal(final Iterable<BigDecimal> left, final Iterable<BigDecimal> right) {\r\n\t\tif (left == null && right == null) return true;\r\n\t\tif (left == null || right == null) return false;\r\n\r\n\t\tfinal Iterator<BigDecimal> leftIterator = left.iterator();\r\n\t\tfinal Iterator<BigDecimal> rightIterator = right.iterator();\r\n\r\n\t\twhile(leftIterator.hasNext() && rightIterator.hasNext()) {\r\n\t\t\tfinal BigDecimal l = leftIterator.next();\r\n\t\t\tfinal BigDecimal r = rightIterator.next();\r\n\t\t\tif (!(l == r || l != null && l.compareTo(r) == 0))\r\n\t\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\treturn leftIterator.hasNext() == rightIterator.hasNext();\r\n\t}\r\n\r\n\tpublic static boolean compareBigDecimal(final BigDecimal[] left, final BigDecimal[] right) {\r\n\t\tif (left == null && right == null) return true;\r\n\t\tif (left == null || right == null) return false;\r\n\r\n\t\tif (left.length != right.length) return false;\r\n\t\tfor (int i = 0; i < left.length; i++) {\r\n\t\t\tfinal BigDecimal l = left[i];\r\n\t\t\tfinal BigDecimal r = right[i];\r\n\t\t\tif (!(l == r || l != null && l.compareTo(r) == 0))\r\n\t\t\t\treturn false;\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n\r\n\tpublic static boolean compareBigDecimal(final Set<BigDecimal> left, final Set<BigDecimal> right) {\r\n\t\tif (left == null && right == null) return true;\r\n\t\tif (left == null || right == null) return false;\r\n\r\n\t\tif (left.size() != right.size()) return false;\r\n\r\n\t\tfor (final BigDecimal l : left) {\r\n\t\t\tboolean found = false;\r\n\t\t\tfor (final BigDecimal r : right) {\r\n\t\t\t\tif (l == r || l != null && l.compareTo(r) == 0) {\r\n\t\t\t\t\tfound = true;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (!found)\r\n\t\t\t\treturn false;\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n\r\n\tpublic static boolean compareBinary(final Iterable<byte[]> left, final Iterable<byte[]> right) {\r\n\t\tif (left == null && right == null) return true;\r\n\t\tif (left == null || right == null) return false;\r\n\r\n\t\tfinal Iterator<byte[]> leftIterator = left.iterator();\r\n\t\tfinal Iterator<byte[]> rightIterator = right.iterator();\r\n\r\n\t\twhile(leftIterator.hasNext() && rightIterator.hasNext()) {\r\n\t\t\tfinal byte[] l = leftIterator.next();\r\n\t\t\tfinal byte[] r = rightIterator.next();\r\n\t\t\tif (!Arrays.equals(l, r))\r\n\t\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\treturn leftIterator.hasNext() == rightIterator.hasNext();\r\n\t}\r\n\r\n\tpublic static boolean compareBinary(final byte[][] left, final byte[][] right) {\r\n\t\tif (left == null && right == null) return true;\r\n\t\tif (left == null || right == null) return false;\r\n\r\n\t\tif (left != null && right != null) {\r\n\t\t\tif (left.length != right.length) return false;\r\n\t\t\tfor (int i = 0; i < left.length; i++) {\r\n\t\t\t\tif (!Arrays.equals(left[i], right[i]))\r\n\t\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\tpublic static boolean compareBinary(final Set<byte[]> left, final Set<byte[]> right) {\r\n\t\tif (left == null && right == null) return true;\r\n\t\tif (left == null || right == null) return false;\r\n\r\n\t\tif (left.size() != right.size()) return false;\r\n\r\n\t\tfor (final byte[] l : left) {\r\n\t\t\tboolean found = false;\r\n\t\t\tfor (final byte[] r : right) {\r\n\t\t\t\tif (Arrays.equals(l, r)) {\r\n\t\t\t\t\tfound = true;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (!found)\r\n\t\t\t\treturn false;\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n}\r\n","Java/namespace.myModule.A.java":"package namespace.myModule;\r\n\r\npublic class A   implements java.io.Serializable, com.dslplatform.patterns.AggregateRoot {\r\n\r\n\tpublic A() {\r\n\r\n\t\t_serviceLocator = com.dslplatform.client.Bootstrap.getLocator();\r\n\t\t_domainProxy = _serviceLocator.resolve(com.dslplatform.client.DomainProxy.class);\r\n\t\t_crudProxy = _serviceLocator.resolve(com.dslplatform.client.CrudProxy.class);\r\n\t\tthis.ID = 0;\r\n\t}\r\n\r\n\tprivate transient final com.dslplatform.patterns.ServiceLocator _serviceLocator;\r\n\tprivate transient final com.dslplatform.client.DomainProxy _domainProxy;\r\n\tprivate transient final com.dslplatform.client.CrudProxy _crudProxy;\r\n\r\n\tprivate String URI;\r\n\r\n\t@com.fasterxml.jackson.annotation.JsonProperty(\"URI\")\r\n\tpublic String getURI()  {\r\n\r\n\t\treturn this.URI;\r\n\t}\r\n\r\n\t@Override\r\n\tpublic int hashCode() {\r\n\t\treturn URI != null ? URI.hashCode() : super.hashCode();\r\n\t}\r\n\r\n\t@Override\r\n\tpublic boolean equals(final Object obj) {\r\n\t\tif (this == obj)\r\n\t\t\treturn true;\r\n\t\tif (obj == null)\r\n\t\t\treturn false;\r\n\r\n\t\tif (getClass() != obj.getClass())\r\n\t\t\treturn false;\r\n\t\tfinal A other = (A) obj;\r\n\r\n\t\treturn URI != null && URI.equals(other.URI);\r\n\t}\r\n\r\n\t@Override\r\n\tpublic String toString() {\r\n\t\treturn URI != null ? \"A(\" + URI + ')' : \"new A(\" + super.hashCode() + ')';\r\n\t}\r\n\r\n\tprivate static final long serialVersionUID = 0x0097000a;\r\n\r\n\t@com.fasterxml.jackson.annotation.JsonCreator private A(\r\n\t\t\t@com.fasterxml.jackson.annotation.JacksonInject(\"_serviceLocator\") final com.dslplatform.patterns.ServiceLocator _serviceLocator,\r\n\t\t\t@com.fasterxml.jackson.annotation.JsonProperty(\"URI\") final String URI ,\r\n\t\t\t@com.fasterxml.jackson.annotation.JsonProperty(\"ID\") final int ID) {\r\n\t\tthis._serviceLocator = _serviceLocator;\r\n\t\tthis._domainProxy = _serviceLocator.resolve(com.dslplatform.client.DomainProxy.class);\r\n\t\tthis._crudProxy = _serviceLocator.resolve(com.dslplatform.client.CrudProxy.class);\r\n\t\tthis.URI = URI;\r\n\t\tthis.ID = ID;\r\n\t}\r\n\r\n\tprivate int ID;\r\n\r\n\t@com.fasterxml.jackson.annotation.JsonProperty(\"ID\")\r\n\t@com.fasterxml.jackson.annotation.JsonInclude(com.fasterxml.jackson.annotation.JsonInclude.Include.NON_EMPTY)\r\n\tpublic int getID()  {\r\n\r\n\t\treturn ID;\r\n\t}\r\n\r\n\tprivate A setID(final int value) {\r\n\r\n\t\tthis.ID = value;\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\tpublic static A find(final String uri) throws java.io.IOException {\r\n\t\treturn find(uri, com.dslplatform.client.Bootstrap.getLocator());\r\n\t}\r\n\tpublic static A find(final String uri, final com.dslplatform.patterns.ServiceLocator locator) throws java.io.IOException {\r\n\t\ttry {\r\n\t\t\treturn (locator != null ? locator : com.dslplatform.client.Bootstrap.getLocator()).resolve(com.dslplatform.client.CrudProxy.class).read(A.class, uri).get();\r\n\t\t} catch (final InterruptedException e) {\r\n\t\t\tthrow new java.io.IOException(e);\r\n\t\t} catch (final java.util.concurrent.ExecutionException e) {\r\n\t\t\tthrow new java.io.IOException(e);\r\n\t\t}\r\n\t}\r\n\tpublic static java.util.List<A> find(final Iterable<String> uris) throws java.io.IOException {\r\n\t\treturn find(uris, com.dslplatform.client.Bootstrap.getLocator());\r\n\t}\r\n\tpublic static java.util.List<A> find(final Iterable<String> uris, final com.dslplatform.patterns.ServiceLocator locator) throws java.io.IOException {\r\n\t\ttry {\r\n\t\t\treturn (locator != null ? locator : com.dslplatform.client.Bootstrap.getLocator()).resolve(com.dslplatform.client.DomainProxy.class).find(A.class, uris).get();\r\n\t\t} catch (final InterruptedException e) {\r\n\t\t\tthrow new java.io.IOException(e);\r\n\t\t} catch (final java.util.concurrent.ExecutionException e) {\r\n\t\t\tthrow new java.io.IOException(e);\r\n\t\t}\r\n\t}\r\n\tpublic static java.util.List<A> findAll() throws java.io.IOException {\r\n\t\treturn findAll(null, null, com.dslplatform.client.Bootstrap.getLocator());\r\n\t}\r\n\tpublic static java.util.List<A> findAll(final com.dslplatform.patterns.ServiceLocator locator) throws java.io.IOException {\r\n\t\treturn findAll(null, null, locator);\r\n\t}\r\n\tpublic static java.util.List<A> findAll(final Integer limit, final Integer offset) throws java.io.IOException {\r\n\t\treturn findAll(limit, offset, com.dslplatform.client.Bootstrap.getLocator());\r\n\t}\r\n\tpublic static java.util.List<A> findAll(final Integer limit, final Integer offset, final com.dslplatform.patterns.ServiceLocator locator) throws java.io.IOException {\r\n\t\ttry {\r\n\t\t\treturn (locator != null ? locator : com.dslplatform.client.Bootstrap.getLocator()).resolve(com.dslplatform.client.DomainProxy.class).findAll(A.class, limit, offset, null).get();\r\n\t\t} catch (final InterruptedException e) {\r\n\t\t\tthrow new java.io.IOException(e);\r\n\t\t} catch (final java.util.concurrent.ExecutionException e) {\r\n\t\t\tthrow new java.io.IOException(e);\r\n\t\t}\r\n\t}\r\n\tpublic static java.util.List<A> search(final com.dslplatform.patterns.Specification<A> specification) throws java.io.IOException {\r\n\t\treturn search(specification, null, null, com.dslplatform.client.Bootstrap.getLocator());\r\n\t}\r\n\tpublic static java.util.List<A> search(final com.dslplatform.patterns.Specification<A> specification, final com.dslplatform.patterns.ServiceLocator locator) throws java.io.IOException {\r\n\t\treturn search(specification, null, null, locator);\r\n\t}\r\n\tpublic static java.util.List<A> search(final com.dslplatform.patterns.Specification<A> specification, final Integer limit, final Integer offset) throws java.io.IOException {\r\n\t\treturn search(specification, limit, offset, com.dslplatform.client.Bootstrap.getLocator());\r\n\t}\r\n\tpublic static java.util.List<A> search(final com.dslplatform.patterns.Specification<A> specification, final Integer limit, final Integer offset, final com.dslplatform.patterns.ServiceLocator locator) throws java.io.IOException {\r\n\t\ttry {\r\n\t\t\treturn (locator != null ? locator : com.dslplatform.client.Bootstrap.getLocator()).resolve(com.dslplatform.client.DomainProxy.class).search(specification, limit, offset, null).get();\r\n\t\t} catch (final InterruptedException e) {\r\n\t\t\tthrow new java.io.IOException(e);\r\n\t\t} catch (final java.util.concurrent.ExecutionException e) {\r\n\t\t\tthrow new java.io.IOException(e);\r\n\t\t}\r\n\t}\r\n\tpublic static long count() throws java.io.IOException {\r\n\t\treturn count(com.dslplatform.client.Bootstrap.getLocator());\r\n\t}\r\n\tpublic static long count(final com.dslplatform.patterns.ServiceLocator locator) throws java.io.IOException {\r\n\t\ttry {\r\n\t\t\treturn (locator != null ? locator : com.dslplatform.client.Bootstrap.getLocator()).resolve(com.dslplatform.client.DomainProxy.class).count(A.class).get().longValue();\r\n\t\t} catch (final InterruptedException e) {\r\n\t\t\tthrow new java.io.IOException(e);\r\n\t\t} catch (final java.util.concurrent.ExecutionException e) {\r\n\t\t\tthrow new java.io.IOException(e);\r\n\t\t}\r\n\t}\r\n\tpublic static long count(final com.dslplatform.patterns.Specification<A> specification) throws java.io.IOException {\r\n\t\treturn count(specification, com.dslplatform.client.Bootstrap.getLocator());\r\n\t}\r\n\tpublic static long count(final com.dslplatform.patterns.Specification<A> specification, final com.dslplatform.patterns.ServiceLocator locator) throws java.io.IOException {\r\n\t\ttry {\r\n\t\t\treturn (locator != null ? locator : com.dslplatform.client.Bootstrap.getLocator()).resolve(com.dslplatform.client.DomainProxy.class).count(specification).get().longValue();\r\n\t\t} catch (final InterruptedException e) {\r\n\t\t\tthrow new java.io.IOException(e);\r\n\t\t} catch (final java.util.concurrent.ExecutionException e) {\r\n\t\t\tthrow new java.io.IOException(e);\r\n\t\t}\r\n\t}\r\n\tprivate void updateWithAnother(final namespace.myModule.A result) {\r\n\t\tthis.URI = result.URI;\r\n\r\n\t\tthis.ID = result.ID;\r\n\t}\r\n\tpublic A persist() throws java.io.IOException {\r\n\t\tfinal A result;\r\n\t\ttry {\r\n\t\t\tresult = this.URI == null ? _crudProxy.create(this).get() : _crudProxy.update(this).get();\r\n\t\t} catch (final InterruptedException e) {\r\n\t\t\tthrow new java.io.IOException(e);\r\n\t\t} catch (final java.util.concurrent.ExecutionException e) {\r\n\t\t\tthrow new java.io.IOException(e);\r\n\t\t}\r\n\t\tthis.updateWithAnother(result);\r\n\t\treturn this;\r\n\t}\r\n\tpublic A delete() throws java.io.IOException {\r\n\t\ttry {\r\n\t\t\treturn _crudProxy.delete(A.class, URI).get();\r\n\t\t} catch (final InterruptedException e) {\r\n\t\t\tthrow new java.io.IOException(e);\r\n\t\t} catch (final java.util.concurrent.ExecutionException e) {\r\n\t\t\tthrow new java.io.IOException(e);\r\n\t\t}\r\n\t}\r\n}\r\n","Java/namespace.myModule.repositories.ARepository.java":"package namespace.myModule.repositories;\r\n\r\npublic class ARepository extends com.dslplatform.client.ClientPersistableRepository<namespace.myModule.A> {\r\n\tpublic ARepository(final com.dslplatform.patterns.ServiceLocator locator) {\r\n\t\tsuper(namespace.myModule.A.class, locator);\r\n\t}\r\n}"}
